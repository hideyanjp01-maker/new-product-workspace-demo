# 页面改造总结 - 洞察期页面

## 修改的文件

### 1. 新增文件
- `src/pages/stages/InsightStagePage.tsx` - 洞察期页面主组件
- `src/pages/stages/InsightStagePage.css` - 洞察期页面样式
- `src/components/layout/PageHeader.tsx` - 页面头部通用组件
- `src/components/layout/PageHeader.css` - 页面头部样式
- `src/components/layout/FilterBar.tsx` - 筛选栏通用组件
- `src/components/layout/FilterBar.css` - 筛选栏样式

### 2. 修改的文件
- `src/App.tsx` - 更新路由，将 `/stages/insight` 路由指向新的 InsightStagePage 组件

## 新增的组件/样式

### 通用组件
1. **PageHeader** (`src/components/layout/PageHeader.tsx`)
   - 功能：统一的页面头部组件
   - Props：title, subtitle, onBack, backPath, actions
   - 特性：返回按钮、标题、副标题、右侧操作按钮区域

2. **FilterBar** (`src/components/layout/FilterBar.tsx`)
   - 功能：统一的筛选栏组件
   - Props：showDateFilter, showSearch, showCategoryFilter
   - 特性：日期范围显示和切换、搜索框、品类筛选

### 页面组件
3. **InsightStagePage** (`src/pages/stages/InsightStagePage.tsx`)
   - 功能：洞察期主页面
   - 特性：
     - 使用 MainLayout 包裹
     - 集成 PageHeader 和 FilterBar
     - 使用 Tabs 组件切换数据看板/AI洞察
     - 市场机会卡片展示
     - 统计数据展示

## 该页面目前支持的交互点清单

### 1. 视图模式切换 ✅
- **位置**：Tabs 组件（数据看板 / AI洞察）
- **功能**：通过 `viewMode` store 状态切换，影响页面展示内容
- **实现**：使用 `useAppStore` 的 `viewMode` 和 `setViewMode`

### 2. 日期范围切换 ✅
- **位置**：FilterBar 组件中的日期切换按钮
- **功能**：切换 dateA/dateB，影响市场机会数据和AI洞察内容
- **实现**：
  - 点击"切换"按钮调用 `setDateRange`
  - 数据根据日期变化：市场规模、增长率、AI洞察文本都会更新
  - 示例：2024-01-01至2024-01-31 ↔ 2024-01-15至2024-02-15

### 3. 推入新品按钮 ✅
- **位置**：每个市场机会卡片的"推入新品"按钮
- **功能**：点击后跳转到企划期页面
- **实现**：`navigate('/stages/planning')`

### 4. 查看详情按钮 ✅
- **位置**：每个市场机会卡片的"查看详情"按钮
- **功能**：打开详情（当前为 console.log，可扩展为 Modal）
- **实现**：可扩展为打开 Modal 显示详细信息

### 5. 返回按钮 ✅
- **位置**：PageHeader 左侧
- **功能**：返回上一页
- **实现**：使用 `navigate(-1)` 或指定路径

### 6. 搜索功能（预留）✅
- **位置**：FilterBar 搜索框
- **功能**：搜索市场机会（当前为本地状态，可扩展）
- **实现**：`searchTerm` state（可扩展为过滤逻辑）

### 7. 品类筛选（预留）✅
- **位置**：FilterBar 品类下拉框
- **功能**：按品类筛选市场机会（当前为本地状态，可扩展）
- **实现**：`category` state（可扩展为过滤逻辑）

## 数据变化验证

### 日期切换影响的数据：

**Period A (2024-01-01 至 2024-01-31)**:
- 智能无线耳机：市场规模 5M，增长率 25%
- 充电宝：市场规模 3M，增长率 15%
- 智能手环：市场规模 8M，增长率 30%

**Period B (2024-01-15 至 2024-02-15)**:
- 智能无线耳机：市场规模 5.5M，增长率 28%
- 充电宝：市场规模 3.2M，增长率 18%
- 智能手环：市场规模 8.5M，增长率 32%

**AI洞察文本也会根据日期切换显示不同的分析内容**

## 样式特性

1. **按钮样式**（优先级最高）：
   - Primary 按钮：绿色背景 (#52c41a)，白色文字
   - Secondary 按钮：白色背景，灰色边框
   - 完整的 hover/active/focus 状态
   - 使用统一的 Button 组件

2. **卡片样式**：
   - 统一圆角、阴影、边框
   - 使用 Card 组件，支持 hoverable

3. **字体系统**：
   - 使用 design tokens 中的字体变量
   - PingFang SC 优先
   - 统一的字体大小和粗细层级

4. **配色系统**：
   - 使用 design tokens 中的颜色变量
   - 绿色主题色
   - 统一的灰阶系统

## 技术实现

1. **全局状态管理**：
   - 使用 `useAppStore` 读取和更新 `dateA`, `dateB`, `viewMode`, `currentStage`
   - 所有状态变更都会影响页面展示

2. **组件化结构**：
   - MainLayout → PageHeader + FilterBar + Tabs → Content
   - 使用 Card, Button, Tabs 等 UI 组件
   - 无静态图片堆叠

3. **响应式数据**：
   - 市场机会数据根据 dateA 动态生成
   - AI洞察内容根据 dateA/dateB 动态生成
   - 统计数据自动计算

## 验收检查

✅ 页面无报错、无白屏
✅ 页面不出现图片纵向罗列（完全组件化实现）
✅ 切换日期与模式可见变化（数据会更新）
✅ 按钮样式统一（使用 ui/Button 组件）
✅ 布局统一（使用 MainLayout）
✅ 路由正常工作（/stages/insight）






# 滚动问题修复说明

## 问题描述
在"企划期"页面中，主内容区底部信息显示不完整，页面无法滚动到底部。

## 根因分析
原来的布局使用了 `position: fixed` 的 TopBar 和 SideNav，主内容区使用 `margin-top` 和 `margin-left` 来避开固定元素。这种布局方式导致：
1. `.main-layout` 使用固定高度 `height: 1080px`
2. `.main-layout-content` 使用 `margin-top`，实际可用高度受限
3. 缺少 `min-height: 0` 导致 flex 布局无法正确计算滚动区域

## 修改的文件

### 1. `src/components/layout/MainLayout.tsx`
- **修改前**：TopBar 和 SideNav 直接放在 `.main-layout` 下，Content 使用 margin 避开固定元素
- **修改后**：添加了 `.main-layout-body` 容器包裹 SideNav 和 Content，使用 flex 布局

### 2. `src/components/layout/MainLayout.css`
- **修改前**：
  ```css
  .main-layout-content {
    margin-left: var(--sidebar-width);
    margin-top: var(--topbar-height);
    min-height: calc(1080px - var(--topbar-height));
    overflow-y: auto;
  }
  ```
- **修改后**：
  ```css
  .main-layout {
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  
  .main-layout-body {
    flex: 1 1 auto;
    display: flex;
    min-height: 0; /* 关键 */
  }
  
  .main-layout-content {
    flex: 1 1 auto;
    min-width: 0; /* 关键 */
    overflow-y: auto;
  }
  ```

### 3. `src/components/layout/TopBar.css`
- **修改前**：`position: fixed; top: 0; left: 0; right: 0;`
- **修改后**：`flex: 0 0 auto;` (在 flex 布局中固定高度)

### 4. `src/components/layout/SideNav.css`
- **修改前**：`position: fixed; top: var(--topbar-height); left: 0; bottom: 0;`
- **修改后**：`flex: 0 0 auto;` (在 flex 布局中固定宽度)
- 添加了 `.layout-sidenav-nav` 的 `min-height: 0` 以支持滚动

## 新的布局结构

```
.main-layout (flex column, height: 1080px, overflow: hidden)
├── .layout-topbar (flex: 0 0 auto, height: 64px)
└── .main-layout-body (flex: 1 1 auto, display: flex, min-height: 0)
    ├── .layout-sidenav (flex: 0 0 auto, width: 240px)
    │   ├── .layout-sidenav-nav (flex: 1, overflow-y: auto, min-height: 0)
    │   └── .layout-sidenav-footer (flex: 0 0 auto)
    └── .main-layout-content (flex: 1 1 auto, min-width: 0, overflow-y: auto)
        └── 页面内容
```

## 关键修改点

1. **根容器 `.main-layout`**：
   - 使用 `display: flex; flex-direction: column;`
   - `overflow: hidden` 防止根容器滚动

2. **Body 容器 `.main-layout-body`**：
   - `flex: 1 1 auto` 占据剩余空间
   - `min-height: 0` **关键**：允许 flex 子项缩小，使 Content 可以滚动

3. **主内容区 `.main-layout-content`**：
   - `flex: 1 1 auto` 占据剩余空间
   - `min-width: 0` **关键**：允许 flex 子项缩小
   - `overflow-y: auto` 承担纵向滚动

4. **TopBar 和 SideNav**：
   - 从 `position: fixed` 改为 `flex: 0 0 auto`
   - 在 flex 布局中固定尺寸

## 验收标准

✅ TopBar 和 SideNav 固定显示，不会滚动
✅ 主内容区（Content）可以纵向滚动
✅ 页面底部信息完整可见
✅ 所有卡片/列表底部内容完整可见

## 哪个容器原来锁死了滚动

**原来的问题容器**：`.main-layout-content`
- 使用了 `margin-top` 和 `margin-left` 避开固定元素
- 缺少 `min-height: 0` 导致在 flex 布局中无法正确计算滚动区域
- 父容器 `.main-layout` 缺少 flex 布局结构

## 修改后的滚动容器

**新的滚动容器**：`.main-layout-content`
- 在 flex 布局结构中正确设置了 `flex: 1 1 auto` 和 `min-width: 0`
- 设置了 `overflow-y: auto` 承担纵向滚动
- 父容器 `.main-layout-body` 设置了 `min-height: 0` 允许子项正确计算滚动区域







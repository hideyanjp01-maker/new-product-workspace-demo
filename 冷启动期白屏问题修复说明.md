# 冷启动期白屏问题修复说明

## 🔍 问题排查步骤

### 步骤1：确认运行时错误

**检查结果**：
- 编译检查：无编译错误
- 代码结构：组件结构完整，有 default export，有 return 语句
- 发现的问题：使用了旧的角色ID `ecommerce-director`，应改为 `ecommerce_owner`

### 步骤2：确认路由配置

**检查结果**：
- ✅ 路由配置正确：`src/App.tsx` 中 `/stages/cold-start` 正确指向 `ColdStartStagePage`
- ✅ 组件导入正确：`import ColdStartStagePage from './pages/stages/ColdStartStagePage'`
- ✅ 组件有 default export

### 步骤3：确认组件是否返回空

**检查结果**：
- ✅ 组件有完整的 return 语句
- ✅ 没有 early return null
- ✅ 有 MainLayout、PageHeader、FilterBar、Tabs 组件
- ✅ 结构完整，应该能正常渲染

### 步骤4：定位问题根因

**根因分析**：
1. **主要问题**：代码中使用了旧的角色ID `ecommerce-director`（2处）
   - 第46行：`navigate(\`/roles/ecommerce-director?product=${productId}\`)`
   - 第132行：`navigate(\`/roles/ecommerce-director?product=${product.id}\`)`
   - 该角色ID在新角色列表中不存在（已改为 `ecommerce_owner`）
   - 虽然这不会直接导致白屏，但会导致导航错误

2. **潜在问题**：如果 products 数组为空，页面仍应显示，但可能看起来像白屏
   - 已添加空状态处理

3. **时间选择器**：冷启动期应显示"新品启动第 X 天"，但 TimeSelector 组件应该在 TopBar 中处理，不影响页面渲染

## 🔧 修复方案

### 修改的文件

1. **`src/pages/stages/ColdStartStagePage.tsx`**
   - 修复角色ID：将 `ecommerce-director` 改为 `ecommerce_owner`（2处）
   - 添加空状态处理：当 products 为空时显示友好提示

### 修复内容

```typescript
// 修复前
navigate(`/roles/ecommerce-director?product=${productId}`)

// 修复后
navigate(`/roles/ecommerce_owner?product=${productId}`)
```

```typescript
// 添加空状态处理
{products.length > 0 ? (
  products.map((product) => (
    // ... 产品卡片
  ))
) : (
  <Card padding="large">
    <div className="empty-state">
      <p>暂无冷启动期产品</p>
    </div>
  </Card>
)}
```

## ✅ 验收标准

修复后的冷启动期页面应包含：

1. ✅ **TopBar** - 显示角色选择器和时间选择器（"新品启动第 X 天"）
2. ✅ **SideNav** - 显示导航菜单
3. ✅ **页面标题** - "冷启动期"
4. ✅ **副标题** - "产品冷启动和运营管理"
5. ✅ **FilterBar** - 筛选栏（虽然冷启动期时间选择器会被禁用，但 FilterBar 容器应显示）
6. ✅ **Tabs** - "数据看板" 和 "AI洞察" 两个标签页
7. ✅ **内容区域** - 至少显示统计卡片和产品列表（或空状态）

## 📝 最小可用骨架

当前的 ColdStartStagePage 组件已经是最小可用骨架，包含：
- MainLayout（TopBar + SideNav + Content）
- PageHeader（标题和副标题）
- FilterBar（筛选栏）
- Tabs（数据看板/AI洞察切换）
- 内容区域（统计卡片 + 产品列表或空状态）

## 🎯 最终结论

**根因**：
- 主要问题：使用了旧的角色ID `ecommerce-director`，应改为 `ecommerce_owner`
- 次要问题：缺少空状态处理（当没有产品时）

**修复方案**：
1. 更新角色ID为 `ecommerce_owner`
2. 添加空状态处理

**涉及文件**：
- `src/pages/stages/ColdStartStagePage.tsx`

**组件代码位置**：
- `src/pages/stages/ColdStartStagePage.tsx` - 冷启动期页面组件
- `src/pages/stages/ColdStartStagePage.css` - 样式文件

修复后，页面应能正常渲染，包含所有必需的布局和内容。





